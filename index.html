<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Adams Apples v2 — Schema Explorer</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="data.js"></script>
  <script defer src="app.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-title">Adams Apples v2</div>
      <div class="brand-sub">Schema explorer • Luna-style diagram + docs</div>
    </div>

    <div class="topbar-center">
      <div class="segmented" role="tablist" aria-label="View">
        <button id="tabDiagram" class="seg active" role="tab" aria-selected="true">Diagram</button>
        <button id="tabDocs" class="seg" role="tab" aria-selected="false">Docs</button>
        <button id="tabGlossary" class="seg" role="tab" aria-selected="false">Glossary</button>
      </div>

      <label class="search">
        <span class="search-label">Search</span>
        <input id="searchInput" type="search" placeholder='Try "trees", "invoice", "health", "generate_"' />
      </label>
    </div>

    <div class="topbar-actions">
      <button id="btnToc" class="btn ghost" title="Open Table of Contents">TOC</button>
      <button id="btnBuildPrint" class="btn">Build Print Doc</button>
      <button id="btnPrint" class="btn ghost">Print</button>
    </div>
  </header>

  <main class="app">
    <aside class="sidebar">
      <section class="counts" aria-label="Counts">
        <div class="count"><div class="n" id="countTables"></div><div class="l">Tables</div></div>
        <div class="count"><div class="n" id="countEnums"></div><div class="l">Enums</div></div>
        <div class="count"><div class="n" id="countViews"></div><div class="l">Views</div></div>
        <div class="count"><div class="n" id="countFunctions"></div><div class="l">Functions</div></div>
        <div class="count"><div class="n" id="countTriggers"></div><div class="l">Triggers</div></div>
        <div class="count"><div class="n" id="countIndexes"></div><div class="l">Indexes</div></div>
      </section>

      <section class="filters">
        <div class="section-title">Object Type</div>
        <div class="chips">
          <button class="chip active" data-type="all">All</button>
          <button class="chip" data-type="table">Tables</button>
          <button class="chip" data-type="enum">Enums</button>
          <button class="chip" data-type="view">Views</button>
          <button class="chip" data-type="function">Functions</button>
          <button class="chip" data-type="trigger">Triggers</button>
        </div>

        <div class="section-title">Domain</div>
        <div id="domainChips" class="chips"></div>
      </section>

      <section class="object-list">
        <div class="section-title">Objects</div>
        <div id="objectList" class="list"></div>
      </section>
    </aside>

    <section class="workspace">
      <div id="diagramView" class="view">
        <div class="canvas-toolbar">
          <div class="hint">Drag to pan • Scroll to zoom • Click a table for details</div>
          <div class="canvas-actions">
            <label class="small-toggle" id="isolateToggle" title="Show only selected table + direct neighbors">
              <input type="checkbox" id="isolateCheckbox" />
              <span>Isolate (1-hop)</span>
            </label>
            <button id="btnResetView" class="btn ghost">Reset view</button>
            <button id="btnFit" class="btn ghost">Fit</button>
            <button id="btnToggleEdges" class="btn ghost" title="Cycle: Focus → All → Off">Edges</button>
          </div>
        </div>
        <div class="canvas">
          <svg id="schemaSvg" class="schema-svg" aria-label="Schema diagram">
            <defs>
              <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
                <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(255,255,255,0.35)"></path>
              </marker>
              <marker id="arrowHi" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
                <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(170,220,255,0.95)"></path>
              </marker>
            </defs>
            <g id="viewport"></g>
          </svg>
        </div>
      </div>

      <div id="docsView" class="view hidden">
        <div class="docs-header">
          <div class="docs-title">Documentation</div>
          <div class="docs-sub">Click an object on the left to read its explanation. Use "Build Print Doc" to generate a full printable version.</div>
        </div>
        <div id="docsContent" class="docs-content"></div>
        <div id="printDoc" class="print-doc hidden" aria-label="Printable documentation"></div>
      </div>

      <div id="glossaryView" class="view hidden">
        <div class="docs-header">
          <div class="docs-title">Database Glossary</div>
          <div class="docs-sub">Plain-language definitions of database concepts used in this schema.</div>
        </div>
        <div id="glossaryContent" class="glossary-content"></div>
      </div>
    </section>

    <aside class="inspector" id="inspector">
      <div class="inspector-header">
        <div class="inspector-title" id="inspectorTitle">Select an object</div>
        <button id="btnCollapseInspector" class="btn ghost small" title="Collapse">⟷</button>
      </div>

      <div class="inspector-tabs">
        <button class="itab active" data-tab="business">Business</button>
        <button class="itab" data-tab="technical">Technical</button>
      </div>

      <div id="inspectorBody" class="inspector-body">
        <div class="empty">Pick a table (diagram) or any object (left panel).</div>
      </div>
    </aside>
  </main>

  <dialog id="tocDialog" class="toc">
    <form method="dialog" class="toc-frame">
      <div class="toc-head">
        <div class="toc-title">Table of Contents</div>
        <button class="btn ghost small" value="close">Close</button>
      </div>
      <div id="tocBody" class="toc-body"></div>
    </form>
  </dialog>
</body>
</html>
